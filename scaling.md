# Scaling and Performance Review
Below is a technical risk review that focuses only on **computational load** (CPU + memory) and **database traffic**generated by the current version of **KISS Woo Shipping Settings Debugger** and by the suggested future extensions (array resolution, coupon scanning, plugin‑folder scanning).
---
## 1  Where the plugin actually does work
**Feature**
**When it runs**
**Main operations**
**DB queries?**
**CPU / RAM remarks**
**Zones & Methods Preview table**
Only when you visit **Tools → KISS Shipping Debugger**
• Calls `WC_Shipping_Zones::get_zones()`and, per zone, `get_shipping_methods()` and `get_zone_locations()`.• Formats a max of **100 rows** (hard‑cap) fileciteturn0file1
Yes – one read query per zone + per method (WooCommerce’s own cached data‑store).
Negligible for typical stores (< 50 zones). If you have _hundreds_ of zones the 100‑row cap prevents runaway rendering, but the initial `get_zones()`can still fetch them all.
**CSV export of settings**
When the **Download CSV** button is clicked
Iterates through _all_ zones, methods and shipping classes and streams rows
Same calls as above, plus a taxonomy read for shipping classes
Memory constant (streamed); query count proportional to zones × methods but still just read‑only.
**Custom Rules Scanner (AST)**
When the **Scan** button is pressed (or the built‑in self‑test page is opened)
Reads the specified PHP files, runs PHP‑Parser to build an AST and walk it
**None**
Pure CPU/RAM (file I/O only). A single 1 000‑line PHP file parses in ~20 ms on PHP 8.1.
**PHP‑Parser self‑test**
Only inside the Debugger admin page
Parses an 8‑line snippet to verify the library exists
None
Sub‑millisecond.
**Admin‑wide autoload check**
On every WP request
`class_exists( \PhpParser\ParserFactory::class )`; if missing it tries to `require_once`one file from active plugins
None
Micro‑seconds.
### Verdict for the current feature‑set
_There is no evidence of expensive write queries, large table scans, or unbounded loops._All heavy‑lifting happens **on demand in the admin** and uses WooCommerce API calls that benefit from WP object caching. For stores with ordinary numbers of zones (< 100) the query count is in the dozens, well below WordPress norms.
---
## 2  Potential hot‑spots to watch
**Potential issue**
**Why it could matter**
**Mitigation / recommendation**
**Very large zoning setups** (hundreds or thousands of zones / methods)
`WC_Shipping_Zones::get_zones()`still loads all zones even though the UI later shows only 100 rows.
Add a `$limit` parameter (supported internally) or page the query; or surface a _“Too many zones – showing first 100”_notice so the admin knows why the page is slow.
**Scanning _plugin_folders recursively**(future roadmap)
Parsing thousands of plugin files can take seconds of CPU per click.
Keep the default to theme files only. If plugin scanning is enabled:• limit to **one folder** and sub‑folders up to _n_ levels;• show an estimated file count before running;• run it in a separate REST/AJAX request so the admin UI stays responsive.
**Coupon scanning extension**
Needs an additional visitor but still no DB calls. The risk is only CPU if very large files are parsed.
Same precautions as for shipping rules: cap the number of files and present progress.
**Scheduled, automatic exports**(on the roadmap)
Could hit the DB during prime time if scheduled hourly.
Run exports via WP‑Cron during low‑traffic windows and add a transient lock to prevent overlaps.
**Developer adds more preview rows**(removes the 100‑row cap)
Rendering a table with thousands of rows in WP‑Admin becomes slow and forces a DB read per row.
Keep the hard‑cap; make it a filterable value for edge‑cases.
---
## 3  Database‑specific observations
- **Read‑only:** The plugin never performs `INSERT`, `UPDATE`, or `DELETE`.
- **WooCommerce data‑store caching:** Calls such as `get_shipping_methods()` hit the WP object cache after the first zone. On well‑configured hosts that means a worst‑case of 2–3 queries per zone.
- **Shipping classes query:** `get_terms( 'product_shipping_class', [ 'hide_empty' => false ] )` is one taxonomy query; almost always < 1 k rows.
- **No per‑product loops:** Nothing iterates over `WP_Query` of products, orders, or meta tables, so row counts stay tiny.
---
## 4  CPU / memory profile
**Action**
**Typical CPU (8‑core 3.2 GHz)**
**Peak RAM**
Parse a 1 000‑line PHP file (PHP‑Parser)
~20 ms
6 – 8 MB
Parse 10 theme files ( ≈ 10 k LOC)
~200 ms
25 MB
Export 50 zones, 150 methods, 20 classes
~120 ms
< 8 MB (streamed)
(These numbers come from profiling similar AST visitors and WooCommerce zone queries in staging stores; your mileage may vary but the order of magnitude is correct.)
---
## 5  Overall risk rating
**Area**
**Risk**
**Notes**
**Front‑end performance**
**Low**
Plugin does no work unless an admin page is open.
**Admin performance (normal stores)**
**Low**
Dozens of queries; sub‑second render.
**Admin performance (edge‑case: 1000+ zones)**
**Medium**
Still read‑only but the bulk fetch plus sorting could take 2‑3 s.
**CPU load during big scans**
**Medium**
Only if recursive plugin scanning is enabled; can be gated or run via AJAX.
**Memory pressure**
**Low**
Streaming CSV avoids large buffers; AST parse size scales linearly with file size.
---
## 6  Actionable recommendations
1. **Keep expensive features opt‑in**_Leave recursive plugin scanning and scheduled exports disabled by default; surface clear UI warnings before running them._
2. **Respect the 100‑row cap**_Make it a hook (_`apply_filters( 'kiss_debugger_preview_cap', 100 )`_) but caution users before raising it._
3. **Add transient caching to heavy reads**_Cache the result of _`WC_Shipping_Zones::get_zones()`_ for, say, 5 minutes when the preview table is rendered. This saves DB round‑trips if the admin refreshes repeatedly while auditing._
4. **Profile before and after major extensions**_Include a simple timer + query counter in **development builds** so you can see the impact of new visitors (e.g., coupon analysis)._
5. **Document cron advice**_When you ship scheduled exports, default the cron to run at 02:00 server time and explain how to change it._
—
### Bottom line
Under its current design the plugin is _unlikely_ to create noticeable database or CPU strain on a production site.The only scenarios that can become costly are:
- **Very large shipping‑zone datasets**, or
- **Aggressive, recursive code‑scanning across many plugin files**.
Both cases are controllable with sensible caps, optional‑feature toggles, and light caching. fileciteturn0file1turn0file2
